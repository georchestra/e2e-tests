{"uid":"4a6798425f6769c9","name":"Test the Datafeeder webapp and links","fullName":"tests.georchestra-base.test_ingest_data#test_import_shp_datafeeder","historyId":"a37b07ec0b274692badb0673e2a84f93","time":{"start":1739199690233,"stop":1739199747022,"duration":56789},"description":"This test attempts to load a SHP file through datafeeder and check links.","descriptionHtml":"<p>This test attempts to load a SHP file through datafeeder and check links.</p>\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"pre\")","statusTrace":"page = <Page url='https://georchestra-127-0-0-1.nip.io/import/fcfeecec-4ebe-4ea3-8d91-33f0e023f926/publishok'>\n\n    @allure.feature(\"geOrchestra\")\n    @allure.story(\"Datafeeder\")\n    @allure.description(\"This test attempts to load a SHP file through datafeeder and check links.\")\n    @allure.title(\"Test the Datafeeder webapp and links\")\n    @pytest.mark.skipif(condition=ConfigurationManager.write_tests_disabled(), reason=\"Write tests are disabled\")\n    def test_import_shp_datafeeder(page: Page):\n        login(page)\n        page.goto(\"/import/\")\n        screenshot_page(page, \"datafeeder\")\n        page.locator(\"input#undefined\").first.set_input_files(os.path.abspath(\"./fixtures/antenne.zip\"))\n        page.get_by_role(\"checkbox\").check()\n        page.get_by_role(\"button\", name=\"Upload\").click()\n        page.get_by_role(\"button\", name=\"-\", exact=True).click()\n        page.get_by_role(\"button\", name=\"WGS84\").click()\n        page.get_by_role(\"button\", name=\"WGS84\").click()\n        page.get_by_role(\"button\", name=\"Lambert\").click()\n        page.get_by_role(\"button\", name=\"OK, my data are correct\").click()\n        page.locator(\"input[type=\\\"text\\\"]\").click()\n        page.locator(\"input[type=\\\"text\\\"]\").fill(\"Antennes\")\n        page.locator(\"textarea[name=\\\"textArea\\\"]\").click()\n        page.locator(\"textarea[name=\\\"textArea\\\"]\").fill(\"Awesome\")\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"textbox\").fill(\"a\")\n        page.locator(\"#tags div\").nth(1).click()\n        page.get_by_role(\"button\", name=\"Addresses\").click()\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"textbox\").click()\n        page.get_by_role(\"textbox\").fill(\"This is the process\")\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"button\", name=\"Submit\").click()\n        screenshot_page(page, \"after-submit-click\")\n        # wait for the data to be ingested\n        page.wait_for_timeout(30000)\n        screenshot_page(page, \"after-ingestion\")\n        expect(page.get_by_role(\"button\", name=\"Metadata record\")).to_be_visible(timeout=15000)\n        expect(page.get_by_role(\"button\", name=\"Map viewer\")).to_be_visible()\n        with page.expect_popup() as page1_info:\n            page.get_by_role(\"button\", name=\"Metadata record\").click()\n        page1 = page1_info.value\n        page.wait_for_timeout(10000)\n        screenshot_page(page1, \"metadata\")\n        expect(page1.get_by_text(\"Awesome\").first).to_be_visible()\n        expect(page1.get_by_text(\"Antennes - WMS\")).to_be_visible()\n        page1.close()\n        with page.expect_popup() as page2_info:\n            page.get_by_role(\"button\", name=\"Map viewer\").click()\n        page2 = page2_info.value\n        screenshot_page(page2, \"mapviewer\")\n        expect(page2.locator(\"canvas\")).to_be_visible()\n        page2.close()\n        with page.expect_popup() as page3_info:\n            page.get_by_role(\"button\", name=\"OGC API\").click()\n        page3 = page3_info.value\n        page3_url = page3_info.value.url\n        screenshot_page(page3, \"ogcapi\")\n>       expect(page3.locator(\"pre\")).to_be_visible()\nE       AssertionError: Locator expected to be visible\nE       Actual value: <element(s) not found> \nE       Call log:\nE         - LocatorAssertions.to_be_visible with timeout 5000ms\nE         -   - waiting for locator(\"pre\")\n\ntests/georchestra-base/test_ingest_data.py:65: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":1,"retriesStatusChange":false,"beforeStages":[{"name":"_verify_url","time":{"start":1739199503516,"stop":1739199503517,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"base_url","time":{"start":1739199503516,"stop":1739199503516,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"pytestconfig","time":{"start":1739199503516,"stop":1739199503516,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"delete_output_dir","time":{"start":1739199503516,"stop":1739199503516,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser_type_launch_args","time":{"start":1739199503517,"stop":1739199503517,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"playwright","time":{"start":1739199503518,"stop":1739199504330,"duration":812},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser","time":{"start":1739199504331,"stop":1739199509006,"duration":4675},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"connect_options","time":{"start":1739199504331,"stop":1739199504331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser_type","time":{"start":1739199504331,"stop":1739199504331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"launch_browser","time":{"start":1739199504331,"stop":1739199504331,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser_context_args","time":{"start":1739199509006,"stop":1739199509006,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_pw_artifacts_folder","time":{"start":1739199509006,"stop":1739199509006,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser_context_args","time":{"start":1739199509006,"stop":1739199509006,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"device","time":{"start":1739199509006,"stop":1739199509006,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"context","time":{"start":1739199690182,"stop":1739199690197,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_artifacts_recorder","time":{"start":1739199690182,"stop":1739199690182,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"new_context","time":{"start":1739199690182,"stop":1739199690182,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"output_path","time":{"start":1739199690182,"stop":1739199690182,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"page","time":{"start":1739199690197,"stop":1739199690232,"duration":35},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"testStage":{"description":"This test attempts to load a SHP file through datafeeder and check links.","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 5000ms\n  -   - waiting for locator(\"pre\")","statusTrace":"page = <Page url='https://georchestra-127-0-0-1.nip.io/import/fcfeecec-4ebe-4ea3-8d91-33f0e023f926/publishok'>\n\n    @allure.feature(\"geOrchestra\")\n    @allure.story(\"Datafeeder\")\n    @allure.description(\"This test attempts to load a SHP file through datafeeder and check links.\")\n    @allure.title(\"Test the Datafeeder webapp and links\")\n    @pytest.mark.skipif(condition=ConfigurationManager.write_tests_disabled(), reason=\"Write tests are disabled\")\n    def test_import_shp_datafeeder(page: Page):\n        login(page)\n        page.goto(\"/import/\")\n        screenshot_page(page, \"datafeeder\")\n        page.locator(\"input#undefined\").first.set_input_files(os.path.abspath(\"./fixtures/antenne.zip\"))\n        page.get_by_role(\"checkbox\").check()\n        page.get_by_role(\"button\", name=\"Upload\").click()\n        page.get_by_role(\"button\", name=\"-\", exact=True).click()\n        page.get_by_role(\"button\", name=\"WGS84\").click()\n        page.get_by_role(\"button\", name=\"WGS84\").click()\n        page.get_by_role(\"button\", name=\"Lambert\").click()\n        page.get_by_role(\"button\", name=\"OK, my data are correct\").click()\n        page.locator(\"input[type=\\\"text\\\"]\").click()\n        page.locator(\"input[type=\\\"text\\\"]\").fill(\"Antennes\")\n        page.locator(\"textarea[name=\\\"textArea\\\"]\").click()\n        page.locator(\"textarea[name=\\\"textArea\\\"]\").fill(\"Awesome\")\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"textbox\").fill(\"a\")\n        page.locator(\"#tags div\").nth(1).click()\n        page.get_by_role(\"button\", name=\"Addresses\").click()\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"textbox\").click()\n        page.get_by_role(\"textbox\").fill(\"This is the process\")\n        page.get_by_role(\"button\", name=\"next\").click()\n        page.get_by_role(\"button\", name=\"Submit\").click()\n        screenshot_page(page, \"after-submit-click\")\n        # wait for the data to be ingested\n        page.wait_for_timeout(30000)\n        screenshot_page(page, \"after-ingestion\")\n        expect(page.get_by_role(\"button\", name=\"Metadata record\")).to_be_visible(timeout=15000)\n        expect(page.get_by_role(\"button\", name=\"Map viewer\")).to_be_visible()\n        with page.expect_popup() as page1_info:\n            page.get_by_role(\"button\", name=\"Metadata record\").click()\n        page1 = page1_info.value\n        page.wait_for_timeout(10000)\n        screenshot_page(page1, \"metadata\")\n        expect(page1.get_by_text(\"Awesome\").first).to_be_visible()\n        expect(page1.get_by_text(\"Antennes - WMS\")).to_be_visible()\n        page1.close()\n        with page.expect_popup() as page2_info:\n            page.get_by_role(\"button\", name=\"Map viewer\").click()\n        page2 = page2_info.value\n        screenshot_page(page2, \"mapviewer\")\n        expect(page2.locator(\"canvas\")).to_be_visible()\n        page2.close()\n        with page.expect_popup() as page3_info:\n            page.get_by_role(\"button\", name=\"OGC API\").click()\n        page3 = page3_info.value\n        page3_url = page3_info.value.url\n        screenshot_page(page3, \"ogcapi\")\n>       expect(page3.locator(\"pre\")).to_be_visible()\nE       AssertionError: Locator expected to be visible\nE       Actual value: <element(s) not found> \nE       Call log:\nE         - LocatorAssertions.to_be_visible with timeout 5000ms\nE         -   - waiting for locator(\"pre\")\n\ntests/georchestra-base/test_ingest_data.py:65: AssertionError","steps":[],"attachments":[{"uid":"477034989daadaff","name":"datafeeder","source":"477034989daadaff.png","type":"image/png","size":259316},{"uid":"74937cc99a7e113b","name":"after-submit-click","source":"74937cc99a7e113b.png","type":"image/png","size":321362},{"uid":"defd03b1e1b972da","name":"after-ingestion","source":"defd03b1e1b972da.png","type":"image/png","size":77940},{"uid":"c0af112a0b5f5fb4","name":"metadata","source":"c0af112a0b5f5fb4.png","type":"image/png","size":443641},{"uid":"afdf19c0f3b59e1e","name":"mapviewer","source":"afdf19c0f3b59e1e.png","type":"image/png","size":4935},{"uid":"687f976b0a524196","name":"ogcapi","source":"687f976b0a524196.png","type":"image/png","size":4331}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":6,"hasContent":true},"afterStages":[{"name":"new_context::0","time":{"start":1739199747030,"stop":1739199748047,"duration":1017},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_artifacts_recorder::0","time":{"start":1739199748048,"stop":1739199748063,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"_pw_artifacts_folder::0","time":{"start":1739199748064,"stop":1739199748064,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"browser::0","time":{"start":1739199748065,"stop":1739199748401,"duration":336},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false},{"name":"playwright::0","time":{"start":1739199748404,"stop":1739199748424,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false}],"labels":[{"name":"feature","value":"geOrchestra"},{"name":"story","value":"Datafeeder"},{"name":"tag","value":"@pytest.mark.skipif(condition=False, reason='Write tests are disabled')"},{"name":"parentSuite","value":"tests.georchestra-base"},{"name":"suite","value":"test_ingest_data"},{"name":"host","value":"fv-az1774-74"},{"name":"thread","value":"16797-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.georchestra-base.test_ingest_data"},{"name":"resultFormat","value":"allure2"}],"parameters":[{"name":"browser_name","value":"'chromium'"}],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"35ae9074da702d5d","status":"failed","statusDetails":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - LocatorAssertions.to_be_visible with timeout 15000ms\n  -   - waiting for get_by_role(\"button\", name=\"Metadata record\")","time":{"start":1739199629330,"stop":1739199689581,"duration":60251}}],"categories":[{"name":"Product defects","matchedStatuses":[],"flaky":false}],"tags":["@pytest.mark.skipif(condition=False, reason='Write tests are disabled')"]},"source":"4a6798425f6769c9.json","parameterValues":["'chromium'"]}